<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="DARIAH-DE">
    <link rel="alternate" type="application/atom+xml" title="Commits as RSS Feed" href="http://github.com/schildwaechter/dariah-de-status-jekyll/commits/master.atom" />
    <!-- CSS Imports -->
    <link rel="stylesheet" href="css/bootstrap.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="css/bootstrap-responsive.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="css/application.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="css/bootstrap-customization.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="css/bootstrap-modal.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="css/font-awesome.css">
    <link rel="stylesheet" href="css/dariah_portal.css" type="text/css" media="screen, projection" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
          <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
          <![endif]-->
    <link rel="shortcut icon" type="image/png" href="img/page_icon.png" />
    <style>

       p:lang(de) {
        display: none;
       }

    </style>
  </head>
  <body>
    <div id="content_layout">
      <div class="span8 main-content-wrapper">
        <div id="content" class="primary-area">

          <h1 id="documentation">Documentation</h1>

<p>The DARIAH-DE status page is generated by <a href="https://jekyllrb.com/">Jekyll</a>.</p>

<h2 id="the-infrastructure-and-its-components">The infrastructure and its components</h2>

<p>The DARIAH-DE infrastructure is modeled using <a href="https://jekyllrb.com/docs/collections/">Jekyll Collections</a>.
The model describes the infrastructure catalogue using four layers:</p>

<ol>
  <li>Services</li>
  <li>Middlewares</li>
  <li>Servers</li>
  <li>Infrastructure</li>
</ol>

<p>Any item is described by a collection entry with the following metadata preamble.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Item</span><span class="nv"> </span><span class="s">Title</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">display'</span>
<span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">This</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">sample</span><span class="nv"> </span><span class="s">entry'</span>
<span class="na">website</span><span class="pi">:</span> <span class="s1">'</span><span class="s">http://item.url/'</span>
<span class="na">teresah_included</span><span class="pi">:</span> <span class="no">true</span>
<span class="na">dependencies</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">/infrastructure/otheritem'</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">/servers/machine'</span>
<span class="nn">---</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">title</code> is required for all entries and used in status messages, for servers this should be the <code class="highlighter-rouge">fqdn</code>.</p>

<p>The fields <code class="highlighter-rouge">description</code> and <code class="highlighter-rouge">website</code> are used for the entries in the list harvested by teresah. The key <code class="highlighter-rouge">teresah_included</code> defaults to <code class="highlighter-rouge">true</code> for services, unless explicity set to <code class="highlighter-rouge">false</code>.</p>

<p>The <code class="highlighter-rouge">dependencies</code> must be stated using the <code class="highlighter-rouge">id</code> of the collection entry, i.e. <code class="highlighter-rouge">/:collection/:name</code> where <code class="highlighter-rouge">:collection</code> is the name of the collection and <code class="highlighter-rouge">:name</code> if the filename without extension of the entry.
If a dependency is listed that does not exist, the follwing error occurs:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Liquid Exception: Liquid error (line 6): divided by 0 in fulllist.md
</code></pre></div></div>

<p>Dependency cycles, i.e. circular dependencies, are not allowed<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>.
Cycles in the dependencies will result in the following error:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Liquid Exception: Liquid error (line xx): Nesting too deep in fulllist.md
</code></pre></div></div>

<p>The full list of all resolved dependencies can be found <a href="/fulllist.html">here</a>.</p>

<h2 id="outages-and-announcements">Outages and Announcements</h2>

<p>All service disruptions and announcements are registered in <a href="https://jekyllrb.com/docs/datafiles/">Jekyll Data Files</a>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="pi">-</span> <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">This</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">heading</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">status</span><span class="nv"> </span><span class="s">page'</span>
  <span class="na">description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">This</span><span class="nv"> </span><span class="s">describes</span><span class="nv"> </span><span class="s">what</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">entry</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">about.'</span>
  <span class="na">hide</span><span class="pi">:</span> <span class="no">false</span>
  <span class="na">date_start</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2017-10-01</span><span class="nv"> </span><span class="s">11:01'</span>
  <span class="na">date_end</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2017-10-02</span><span class="nv"> </span><span class="s">14:38'</span>
  <span class="na">affected</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">/infrastructure/otheritem'</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">/servers/machine'</span>
  <span class="na">affected_services</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">DARIAH</span><span class="nv"> </span><span class="s">Website'</span>
</code></pre></div></div>

<p>Using <a href="https://shopify.github.io/liquid/">Liquid</a> processing, all services depending on any (or listed as) item in the <code class="highlighter-rouge">affected</code> array are shown on the status page.
The items of the <code class="highlighter-rouge">affected</code> array use the same <code class="highlighter-rouge">id</code> schema as the infrastructure components dependencies.
In case a nonexisting item is listed, the same division by zero will be caused.</p>

<p>Explicit listing using the <code class="highlighter-rouge">affected_services</code> is discouraged in favour od dynamic catalogue resolution and it will be ignored if the <code class="highlighter-rouge">affected</code> array is present.</p>

<p>The field <code class="highlighter-rouge">hide</code> defaults to <code class="highlighter-rouge">false</code> if absent, but can be used to hide messages from the status page.
Outages with a set <code class="highlighter-rouge">date_end</code> will also not be shown on the status page.</p>

<h2 id="history">History</h2>

<p>For documentation purposes, previous outages and announcements can be added to the <a href="/history.html">History</a>.</p>

<p>Since the catalogue may change, the history can not be generated by dynamically resolving dependencies.
Affected services must therefore be specified using the <code class="highlighter-rouge">affected_services</code> array.
To facilitate maintenance of the history, resolved outages and announcements (even if hidden) are listed on the <a href="/current_entries.html">current entries</a> page.</p>

<h2 id="teresah">TERESAH</h2>

<p>The DARIAH-DE Status Jekyll page also includes the page with all DARIAH-DE services to be harvested by TERESAH.
This includes all services except those explicitly excluded and all middlewares that are explicitly included, as long they have a <code class="highlighter-rouge">title</code>, <code class="highlighter-rouge">description</code> and <code class="highlighter-rouge">website</code> element.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>Limiting recursion depth doesnâ€™t help, as than by the current design all services connected to the cycle would be affected by any outage.&nbsp;<a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>


        </div>
        <div class="row">
          <div class="central_logo_de"></div>
          <div class="pull-right" style="margin-bottom:5px;margin-right:5px">
            <a href="http://github.com/schildwaechter/dariah-de-status-jekyll">
              <span class="">View on GitHub</span>
              <img width="20px" src="img/GitHub-Mark/PNG/GitHub-Mark-32px.png"></img>
            </a>
          </div>
        </div>
      </div>
      <div class="row dfooter footer">
        <div class="span7">
          <!--<div class="row">-->
            <hr/>
            <p>
              Digital Research Infrastructure for the Arts and Humanities.
              <a class="pull-right" href="https://de.dariah.eu/Impressum">Imprint</a>
            </p>

          <!--</div>-->
        </div>
      </div>
    </div>
    <script type="text/javascript" src="js/jquery-1.8.2.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function(event) {
      $.get('textgrid/repstatus.html', function(data) {
        var statusHtml = $(data).filter('.repstatus, .status').not('.ok');
        console.log(statusHtml)
        $(statusHtml).each(function (id, val) {
          //$("#repstatus").prepend(val);
          var status;
          if($(val).hasClass('warning')) {
            document.getElementById("TextGridWarning").style.display="";
            status='<div class="alert alert-warning"><h3>TextGrid Service Warning</h3><p id="TGtext"></p></div>';
            $("#repstatusWarning").prepend(status);
          } else if ($(val).hasClass('error')) {
            document.getElementById("TextGridError").style.display="";
            status='<div class="alert alert-error">TextGrid Service Error<p id="TGtext"></p></div>';
            $("#repstatusError").prepend(status);
          } else if ($(val).hasClass('info')) {
            document.getElementById("TextGridWarning").style.display="";
            status='<h3>TextGrid Info</h3><p id="TGtext"></p>';
            $("#repstatusWarning").prepend(status);
          }
          $("#TGtext").prepend(val);
        });
      }, "html")
    });
    </script>
  </body>
</html>
